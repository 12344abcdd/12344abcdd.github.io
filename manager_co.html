<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>GitHub 仓库管理器</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        html, body { height: 100%; }
        body {
            font-family: "Segoe UI", "Helvetica Neue", Arial, "Liberation Sans", sans-serif;
            background: #f6f8fa;
            margin: 0;
            min-height: 100vh;
        }
        .gh-header {
            background: #24292e;
            color: #fff;
            padding: 16px 32px;
            font-size: 1.5em;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .gh-header img { width: 32px; margin-right: 10px; }
        .gh-header-left { display: flex; align-items: center; }
        .gh-header-right { font-size: 0.8em; }
        .container {
            max-width: 1200px; 
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }
        .gh-table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .gh-table th, .gh-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #eaecef;
        }
        .gh-table th { 
            background: #f6f8fa;
            font-weight: 600;
        }
        .gh-table tr:hover { background: #f8f9fa; }
        .gh-editor {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #fff;
            z-index: 1000;
            display: none;
            flex-direction: column;
        }
        .gh-editor-header {
            background: #24292e;
            color: #fff;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .gh-editor-title {
            font-size: 1.2em;
            margin: 0;
            flex-grow: 1;
            margin-right: 20px;
        }
        .gh-editor-actions {
            display: flex;
            gap: 10px;
        }
        .gh-editor-main {
            display: flex;
            height: calc(100vh - 60px);
        }
        .gh-editor-sidebar {
            width: 250px;
            background: #f6f8fa;
            border-right: 1px solid #e1e4e8;
            padding: 20px;
            overflow-y: auto;
        }
        .gh-editor-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .gh-editor-textarea {
            width: 100%;
            height: 100%;
            padding: 20px;
            border: none;
            resize: none;
            font-family: Monaco, 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            outline: none;
        }
        .gh-action-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .gh-action-list li {
            margin-bottom: 8px;
        }
        .gh-action-btn {
            width: 100%;
            text-align: left;
            padding: 8px 12px;
            background: #fff;
            border: 1px solid #d1d5da;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        .gh-action-btn:hover {
            background: #f3f4f6;
        }
        .btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        .btn-primary {
            background: #238636;
            color: #fff;
        }
        .btn-primary:hover { background: #2ea043; }
        .btn-secondary {
            background: #f3f4f6;
            color: #24292e;
            border: 1px solid #d1d5da;
        }
        .btn-secondary:hover { background: #e9ebef; }
        .btn-danger {
            background: #da3633;
            color: #fff;
        }
        .btn-danger:hover { background: #b62825; }
        .gh-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 24px;
            background: #24292e;
            color: #fff;
            border-radius: 6px;
            display: none;
            z-index: 2000;
        }
    </style>
</head>
<body>
    <div class="gh-header">
        <div class="gh-header-left">
            <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub">
            <span>仓库管理器</span>
        </div>
        <div class="gh-header-right">
            <span>当前用户: abcdd12344abcdd</span>
            <span style="margin-left: 20px;">UTC: 2025-08-20 06:10:20</span>
        </div>
    </div>

    <div class="container">
        <div style="margin-bottom: 20px">
            <button class="btn btn-primary" onclick="newFile()">新建文件</button>
            <button class="btn btn-secondary" onclick="uploadFile()">上传文件</button>
        </div>

        <table class="gh-table">
            <thead>
                <tr>
                    <th>名称</th>
                    <th>大小</th>
                    <th>最后修改</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody id="fileList"></tbody>
        </table>
    </div>

    <div class="gh-editor" id="editor">
        <div class="gh-editor-header">
            <h2 class="gh-editor-title" id="editorTitle">编辑文件</h2>
            <div class="gh-editor-actions">
                <button class="btn btn-primary" onclick="saveFile()">保存</button>
                <button class="btn btn-danger" onclick="closeEditor()">关闭</button>
            </div>
        </div>
        <div class="gh-editor-main">
            <div class="gh-editor-sidebar">
                <h3>Actions</h3>
                <ul class="gh-action-list">
                    <li><button class="gh-action-btn" onclick="formatCode()">格式化代码</button></li>
                    <li><button class="gh-action-btn" onclick="toggleWordWrap()">切换自动换行</button></li>
                    <li><button class="gh-action-btn" onclick="runLint()">代码检查</button></li>
                    <li><button class="gh-action-btn" onclick="insertSnippet()">插入代码片段</button></li>
                </ul>
                <h3>文件信息</h3>
                <div id="fileInfo" style="font-size: 14px; color: #57606a;"></div>
            </div>
            <div class="gh-editor-content">
                <textarea id="editorTextarea" class="gh-editor-textarea"></textarea>
            </div>
        </div>
    </div>

    <div class="gh-toast" id="toast"></div>

    <script>
        // 全局变量
        let currentFile = null;
        let isEditorOpen = false;
        let wordWrapEnabled = true;

        // 初始化
        async function init() {
            await loadFileList();
            setupEventListeners();
        }

        // 加载文件列表
        async function loadFileList() {
            try {
                const response = await fetch(`https://api.github.com/repos/abcdd12344abcdd/repo-name/contents/`);
                const files = await response.json();
                
                const tbody = document.getElementById('fileList');
                tbody.innerHTML = '';
                
                files.forEach(file => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${file.name}</td>
                        <td>${formatFileSize(file.size)}</td>
                        <td>${formatDate(new Date())}</td>
                        <td>
                            <button class="btn btn-secondary" onclick="editFile('${file.path}')">编辑</button>
                            <button class="btn btn-danger" onclick="deleteFile('${file.path}')">删除</button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (error) {
                showToast('加载文件列表失败', 'error');
            }
        }

        // 编辑器相关功能
        function openEditor(path, content) {
            currentFile = path;
            isEditorOpen = true;
            document.getElementById('editor').style.display = 'flex';
            document.getElementById('editorTitle').textContent = `编辑: ${path}`;
            document.getElementById('editorTextarea').value = content;
            updateFileInfo(path);
        }

        function closeEditor() {
            isEditorOpen = false;
            currentFile = null;
            document.getElementById('editor').style.display = 'none';
            document.getElementById('editorTextarea').value = '';
        }

        async function saveFile() {
            if (!currentFile) return;

            try {
                const content = document.getElementById('editorTextarea').value;
                // 这里添加实际的文件保存逻辑
                showToast('文件保存成功');
                await loadFileList();
            } catch (error) {
                showToast('保存失败', 'error');
            }
        }

        // Action 功能
        function formatCode() {
            try {
                const textarea = document.getElementById('editorTextarea');
                const content = textarea.value;
                
                // 这里可以根据文件类型选择不同的格式化方法
                let formatted = content;
                try {
                    // 尝试 JSON 格式化
                    formatted = JSON.stringify(JSON.parse(content), null, 2);
                } catch {
                    // 如果不是 JSON，使用简单的缩进格式化
                    formatted = formatText(content);
                }
                
                textarea.value = formatted;
                showToast('代码格式化完成');
            } catch (error) {
                showToast('格式化失败', 'error');
            }
        }

        function toggleWordWrap() {
            wordWrapEnabled = !wordWrapEnabled;
            document.getElementById('editorTextarea').style.whiteSpace = wordWrapEnabled ? 'pre-wrap' : 'pre';
            showToast(`${wordWrapEnabled ? '启用' : '禁用'}自动换行`);
        }

        function runLint() {
            showToast('运行代码检查...');
            // 这里添加实际的 lint 逻辑
            setTimeout(() => {
                showToast('代码检查完成');
            }, 1000);
        }

        function insertSnippet() {
            const snippets = {
                html: '<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>Document</title>\n</head>\n<body>\n\n</body>\n</html>',
                js: '// JavaScript Template\nfunction main() {\n    // Your code here\n}\n\nmain();',
                css: '/* CSS Template */\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 20px;\n}',
            };

            const ext = currentFile.split('.').pop().toLowerCase();
            const snippet = snippets[ext] || '# New File\n# Created: ' + new Date().toISOString();
            
            const textarea = document.getElementById('editorTextarea');
            const pos = textarea.selectionStart;
            textarea.value = textarea.value.substring(0, pos) + snippet + textarea.value.substring(textarea.selectionEnd);
            showToast('插入代码片段成功');
        }

        // 工具函数
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        function formatText(text) {
            const lines = text.split('\n');
            let indent = 0;
            const formatted = lines.map(line => {
                line = line.trim();
                if (line.endsWith('{')) indent++;
                const spaces = '  '.repeat(Math.max(0, indent - (line.endsWith('}') ? 1 : 0)));
                if (line.startsWith('}')) indent--;
                return spaces + line;
            });
            return formatted.join('\n');
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'success' ? '#238636' : '#da3633';
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        function updateFileInfo(path) {
            const info = document.getElementById('fileInfo');
            info.innerHTML = `
                <p>文件名: ${path}</p>
                <p>路径: /${path}</p>
                <p>修改时间: ${new Date().toLocaleString()}</p>
            `;
        }

        // 事件监听器
        function setupEventListeners() {
            // 快捷键支持
            document.addEventListener('keydown', e => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key.toLowerCase()) {
                        case 's':
                            if (isEditorOpen) {
                                e.preventDefault();
                                saveFile();
                            }
                            break;
                        case 'w':
                            if (isEditorOpen) {
                                e.preventDefault();
                                closeEditor();
                            }
                            break;
                    }
                }
            });

            // 编辑器自动保存
            let autoSaveTimeout;
            document.getElementById('editorTextarea').addEventListener('input', () => {
                clearTimeout(autoSaveTimeout);
                autoSaveTimeout = setTimeout(() => {
                    if (isEditorOpen) {
                        saveFile();
                    }
                }, 3000);
            });
        }

        // 文件操作函数
        async function newFile() {
            const name = prompt('请输入文件名:');
            if (!name) return;
            
            try {
                // 这里添加创建文件的逻辑
                openEditor(name, '');
                showToast('新文件已创建');
            } catch (error) {
                showToast('创建文件失败', 'error');
            }
        }

        async function editFile(path) {
            try {
                // 这里添加获取文件内容的逻辑
                const content = '// 文件内容示例\n';
                openEditor(path, content);
            } catch (error) {
                showToast('打开文件失败', 'error');
            }
        }

        async function deleteFile(path) {
            if (!confirm(`确定要删除 ${path} 吗？`)) return;
            
            try {
                // 这里添加删除文件的逻辑
                await loadFileList();
                showToast('文件已删除');
            } catch (error) {
                showToast('删除文件失败', 'error');
            }
        }

        function uploadFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.onchange = async e => {
                const file = e.target.files[0];
                if (!file) return;
                
                try {
                    // 这里添加文件上传的逻辑
                    await loadFileList();
                    showToast('文件上传成功');
                } catch (error) {
                    showToast('上传文件失败', 'error');
                }
            };
            input.click();
        }

        // 启动应用
        init();
    </script>
</body>
</html>
